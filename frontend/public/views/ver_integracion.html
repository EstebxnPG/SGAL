<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gesti√≥n de ciclo de cultivos</title>
    <link rel="stylesheet" href="/frontend/public/css/pages/form-agregar-modificar.css">
    <link rel="stylesheet" href="/frontend/public/css/pages/agregar-modificar.css">
    <script src="/agregar/js/cargar_script.js"></script>
    <script src="/frontend/public/views/components/js/aside-bar.js" defer></script>
    
</head>
  <body class="page">
    <aside class="sidebar">
    </aside>
    <div class="dashboard">
      <h1 class="dashboard__title">üîó Panel de Integraci√≥n</h1>
  
    <div class="dashboard__grid">
        <div class="card"><strong class="card__label">ID Integraci√≥n</strong>1</div>
        <div class="card"><strong class="card__label">Nombre</strong>Integraci√≥n de Papas</div>
        <div class="card"><strong class="card__label">Estado</strong>ACTIVO</div>
        <div class="card"><strong class="card__label">Fecha Inicial</strong>23/04/22</div>
        <div class="card"><strong class="card__label">Fecha Final</strong>23/04/22</div>
        <div class="card">
          <strong class="card__label">Usuarios</strong>
          Manuel<br />David<br />Carlos
        </div>
        <div class="card">
          <strong class="card__label">Descripci√≥n</strong>
          Descripci√≥n breve de la integraci√≥n...
        </div>
        <div class="card">
          <strong class="card__label">Fotograf√≠a</strong>
          <img class="card__image" src="https://via.placeholder.com/200" alt="Fotograf√≠a" />
        </div>
        <div class="card">
          <strong class="card__label">üí≤ Precio Unitario</strong>
          $1.500
        </div>
        <div class="card card--sensores">
            <strong class="card__label">Sensores</strong>
            <canvas id="canvasSensores" width="200" height="100"></canvas>
          </div>
          <div class="card card--insumos">
            <strong class="card__label">Insumos</strong>
            <canvas id="canvasInsumos" width="200" height="100"></canvas>
          </div>
          <div class="card card--cicloCultivo">
            <strong class="card__label">Ciclos Cultivos</strong>
            <canvas id="canvasCicloCultivo" width="200" height="100"></canvas>
          </div>
      </div>
      <!-- <div class="dashboard__actions">
        <button class="button button--edit">‚úèÔ∏è Editar</button>
        <button class="button button--delete">üóëÔ∏è Eliminar</button>
      </div> -->
    </div>
<script src="/frontend/public/js/pages/ciclo_Cultivo.js"></script>
<script>
    // Funci√≥n para generar datos aleatorios
    function generarDatos(cantidad, max) {
        return Array.from({ length: cantidad }, () => Math.floor(Math.random() * max));
    }
    
    // Funci√≥n para animar la transici√≥n entre valores
    function animarDatos(prev, next, steps = 30) {
        const resultado = [];
        for (let i = 0; i < prev.length; i++) {
            const paso = (next[i] - prev[i]) / steps;
            resultado.push({ actual: prev[i], paso });
        }
        return resultado;
    }
    
    // Funci√≥n para dibujar la cuadr√≠cula
    function dibujarCuadricula(canvas) {
        const ctx = canvas.getContext("2d");
        const espacio = 20;
        
        ctx.strokeStyle = "#e0e0e0";
        ctx.lineWidth = 0.5;
        
        for (let i = 0; i < canvas.height; i += espacio) {
            ctx.beginPath();
            ctx.moveTo(0, i);
            ctx.lineTo(canvas.width, i);
            ctx.stroke();
        }
        
        for (let i = 0; i < canvas.width; i += espacio) {
            ctx.beginPath();
            ctx.moveTo(i, 0);
            ctx.lineTo(i, canvas.height);
            ctx.stroke();
        }
    }
    
    // Gr√°fico de barras animado
    function dibujarBarrasAnimado(canvasId, valoresActuales, nuevosValores, color) {
        const canvas = document.getElementById(canvasId);
        if (!canvas) return;
        
        const ctx = canvas.getContext("2d");
        const pasos = animarDatos(valoresActuales, nuevosValores);
        
        let frame = 0;
        function animar() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            dibujarCuadricula(canvas);
            
            const espacio = 10;
            const ancho = (canvas.width - espacio * (pasos.length + 1)) / pasos.length;
            
            pasos.forEach((p, i) => {
                const valor = p.actual + p.paso * frame;
                const x = espacio + i * (ancho + espacio);
                const y = canvas.height - valor;
                
                ctx.fillStyle = color;
                ctx.fillRect(x, y, ancho, valor);
            });
            
            if (frame < 30) {
                frame++;
                requestAnimationFrame(animar);
            }
        }
        animar();
    }
    
    // Gr√°fico de √°rea animado
    function dibujarAreaAnimado(canvasId, valoresActuales, nuevosValores, color) {
        const canvas = document.getElementById(canvasId);
        if (!canvas) return;
        
        const ctx = canvas.getContext("2d");
        const pasos = animarDatos(valoresActuales, nuevosValores);
        
        let frame = 0;
        function animar() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            dibujarCuadricula(canvas);
            
            ctx.beginPath();
            ctx.moveTo(0, canvas.height);
            
            const gradiente = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradiente.addColorStop(0, color);
            gradiente.addColorStop(1, "rgba(66, 165, 245, 0.1)");
            
            for (let i = 0; i < pasos.length; i++) {
                const x = (canvas.width / (pasos.length - 1)) * i;
                const y = canvas.height - (pasos[i].actual + pasos[i].paso * frame);
                if (i === 0) {
                    ctx.moveTo(x, canvas.height);
                    ctx.lineTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            
            ctx.lineTo(canvas.width, canvas.height);
            ctx.closePath();
            ctx.fillStyle = gradiente;
            ctx.fill();
            
            if (frame < 30) {
                frame++;
                requestAnimationFrame(animar);
            }
        }
        animar();
    }
    
    // Gr√°fico circular animado
    function dibujarCircularAnimado(canvasId, porcentajeActual, porcentajeNuevo, color) {
        const canvas = document.getElementById(canvasId);
        if (!canvas) return;
        
        const ctx = canvas.getContext("2d");
        const paso = (porcentajeNuevo - porcentajeActual) / 30;
        
        let frame = 0;
        function animar() {
            const porcentaje = porcentajeActual + paso * frame;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const x = canvas.width / 2;
            const y = canvas.height / 2;
            const radio = Math.min(canvas.width, canvas.height) / 3;
            
            // C√≠rculo base
            ctx.beginPath();
            ctx.arc(x, y, radio, 0, 2 * Math.PI);
            ctx.strokeStyle = "#ccc";
            ctx.lineWidth = 8;
            ctx.stroke();
            
            // Arco de progreso
            ctx.beginPath();
            ctx.arc(x, y, radio, -Math.PI / 2, (2 * Math.PI * porcentaje) / 100 - Math.PI / 2);
            ctx.strokeStyle = color;
            ctx.stroke();
            
            // Texto del porcentaje
            ctx.fillStyle = color;
            ctx.font = "bold 16px Arial";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillText(Math.round(porcentaje) + "%", x, y);
            
            if (frame < 30) {
                frame++;
                requestAnimationFrame(animar);
            }
        }
        animar();
    }
    
    // Estados iniciales
    let datosSensores = generarDatos(4, 100);
    let datosInsumos = generarDatos(5, 100);
    let porcentajeCiclo = Math.floor(Math.random() * 100);
    
    // Funci√≥n para actualizar todos los gr√°ficos
    function actualizarGraficos() {
        const nuevosSensores = generarDatos(4, 100);
        const nuevosInsumos = generarDatos(5, 100);
        const nuevoCiclo = Math.floor(Math.random() * 100);
        
        dibujarBarrasAnimado("canvasSensores", datosSensores, nuevosSensores, "#66bb6a");
        dibujarAreaAnimado("canvasInsumos", datosInsumos, nuevosInsumos, "#42a5f5");
        dibujarCircularAnimado("canvasCicloCultivo", porcentajeCiclo, nuevoCiclo, "#ffa726");
        
        datosSensores = nuevosSensores;
        datosInsumos = nuevosInsumos;
        porcentajeCiclo = nuevoCiclo;
    }
    
    // Iniciar los gr√°ficos y actualizarlos cada 5 segundos
    document.addEventListener('DOMContentLoaded', () => {
        actualizarGraficos();
        setInterval(actualizarGraficos, 5000);
    });
    </script>
</body>

</html>
